# binfmt for old world executable

qemu-aarch64:

\x7f ELF          \x02\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\xb7\x00
\xff \xff\xff\xff \xff\xff\xff\x00\xff\xff\xff\xff\xff\xff\xff\xff\xfe\xff\xff\xff

1. EI_MAG0 to EI_MAG3: \x7F ELF
2. EI_CLASS: \x02 for 64bit
3. EI_DATA: \x01 little endian
4. EI_VERSION: \x01
5. EI_OSABI: \x00 mask \x00, ignored
6. EI_ABIVERSION: \x00
7. EI_PAD: \x00 until 0x10
8. e_type: ET_EXEC \x02 or ET_REL 0x01
9. e_machine: \xB7 AArch64

Old world e.g WPS:

\x7f ELF          \x02\x01\x01\x03\x00\x00\x00\x00\x00\x00\x00\x00
\x02\x00\x02\x01\x01\x00\x00\x00 e_entry:8
e_phoff:8 e_shoff:8
\x03

New world:

\x7f ELF          \x02\x01\x01\x03\x00\x00\x00\x00\x00\x00\x00\x00
\x02\x00\x02\x01\x01\x00\x00\x00 e_entry:8
e_phoff:8 e_shoff:8
\x43

flags: \x40 means new world, \x00 means old world

match:

\x7fELF\x02\x01\x01\x03\x00\x00\x00\x00\x00\x00\x00\x00
\x02\x00\x02\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00
\x00

\xff\xff\xff\xff\xff\xff\xff\x00\xff\xff\xff\xff\xff\xff\xff\xff
\xfe\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00
\x40

final:

:la_ow_ptrace:M::\x7fELF\x02\x01\x01\x03\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x02\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00:\xff\xff\xff\xff\xff\xff\xff\x00\xff\xff\xff\xff\xff\xff\xff\xff\xfe\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40:/data/common/la_ow_ptrace/build/la_ow:

But it's hard to handle recursion: we want to let child process run without la_ow as interpreter.